import{a as b}from"./chunk-W34LC3UO.js";import{b as h}from"./chunk-MCHRC6DH.js";import{$ as t,H as o,ca as p,ha as l,k as c,r as a}from"./chunk-56OTQPDQ.js";var d=class r{constructor(e){this.http=e}apiUrl=`${b.apiBaseUrl}/api/secciones`;seccionesSubject=new c([]);secciones$=this.seccionesSubject.asObservable();listar(){return this.http.get(this.apiUrl).pipe(t(e=>this.seccionesSubject.next(e)),o(this.handleError("listar",[])))}obtenerPorId(e){return this.http.get(`${this.apiUrl}/${e}`).pipe(o(this.handleError(`obtenerPorId id=${e}`)))}crear(e){return this.http.post(`${this.apiUrl}/crear`,e).pipe(t(i=>this.actualizarCacheSeccion(i)),o(this.handleError("crear")))}actualizar(e,i){return this.http.put(`${this.apiUrl}/actualizar/${e}`,i).pipe(t(n=>this.actualizarCacheSeccion(n)),o(this.handleError("actualizar")))}eliminar(e){return this.http.delete(`${this.apiUrl}/${e}`).pipe(t(()=>this.eliminarDelCache(e)),o(this.handleError("eliminar")))}cambiarEstado(e,i){return this.http.patch(`${this.apiUrl}/${e}/estado`,{activa:i}).pipe(t(n=>this.actualizarCacheSeccion(n)),o(this.handleError("cambiarEstado")))}reordenar(e){return this.http.put(`${this.apiUrl}/reordenar`,{secciones:e}).pipe(t(i=>this.seccionesSubject.next(i)),o(this.handleError("reordenar",[])))}obtenerVistaPreviaPeriodicoCompleto(){return this.http.get(`${this.apiUrl}/vista-previa`).pipe(o(this.handleError("obtenerVistaPreviaPeriodicoCompleto")))}obtenerSeccionesActivasConContenido(){return this.http.get(`${this.apiUrl}/activas/contenido`).pipe(o(this.handleError("obtenerSeccionesActivasConContenido",[])))}obtenerSeccionesActivas(){return this.http.get(`${this.apiUrl}/activas`).pipe(o(this.handleError("obtenerSeccionesActivas",[])))}obtenerPorTipo(e){return this.http.get(`${this.apiUrl}/tipo/${e}`).pipe(o(this.handleError("obtenerPorTipo",[])))}actualizarCacheSeccion(e){let i=this.seccionesSubject.value,n=i.findIndex(s=>s.id===e.id);n!==-1?i[n]=e:i.push(e),this.seccionesSubject.next([...i])}eliminarDelCache(e){let n=this.seccionesSubject.value.filter(s=>s.id!==e);this.seccionesSubject.next(n)}handleError(e="operation",i){return n=>(console.error(`${e} failed:`,n),a(()=>n))}static \u0275fac=function(i){return new(i||r)(l(h))};static \u0275prov=p({token:r,factory:r.\u0275fac,providedIn:"root"})};export{d as a};
