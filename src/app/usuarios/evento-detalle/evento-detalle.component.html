<div class="evento-detalle-container">
  <!-- Loading -->
  <div *ngIf="cargando" class="loading-container">
    <mat-progress-spinner mode="indeterminate"></mat-progress-spinner>
    <p>Cargando evento...</p>
  </div>

  <!-- Contenido del evento -->
  <div *ngIf="!cargando && evento" class="evento-content">
    <!-- Header con navegación -->
    <div class="header-nav">
      <button mat-raised-button color="primary" (click)="volverAlDashboard()" class="back-button">
        <mat-icon>arrow_back</mat-icon>
        Volver al Dashboard
      </button>
    </div>

    <!-- Imagen del evento -->
    <div class="imagen-evento" *ngIf="evento.imagenEvento">
      <img [src]="evento.imagenEvento" [alt]="evento.nombre">
    </div>

    <!-- Información del evento -->
    <mat-card class="evento-card">
      <mat-card-header>
        <mat-card-title>{{ evento.nombre }}</mat-card-title>
        <mat-card-subtitle>
          <div class="meta-info">
            <div class="meta-item">
              <mat-icon>event</mat-icon>
              <span>{{ extraerFecha(evento.fecha) | date:'EEEE, dd MMMM yyyy':'es' }}</span>
            </div>
            <div class="meta-item">
              <mat-icon>schedule</mat-icon>
              <span>{{ extraerHora(evento.fecha, evento.hora) }} hrs</span>
            </div>
            <div class="meta-item" *ngIf="evento.lugar">
              <mat-icon>location_on</mat-icon>
              <span>{{ evento.lugar }}</span>
            </div>
            <div class="meta-item" *ngIf="evento.ciudad">
              <mat-icon>location_city</mat-icon>
              <span>{{ evento.ciudad }}</span>
            </div>
            <div class="meta-item" *ngIf="evento.competicion || evento.competencia">
              <mat-icon>emoji_events</mat-icon>
              <span>{{ evento.competicion || evento.competencia }}</span>
            </div>
            <div class="meta-item" *ngIf="evento.tipoEvento">
              <mat-icon>sports</mat-icon>
              <span>{{ evento.tipoEvento }}</span>
            </div>
            <div class="meta-item" *ngIf="evento.importancia">
              <mat-icon>priority_high</mat-icon>
              <span>Importancia: {{ evento.importancia }}</span>
            </div>
            <div class="meta-item" *ngIf="evento.precioEstimado || evento.valorEstimado">
              <mat-icon>attach_money</mat-icon>
              <span>${{ (evento.precioEstimado || evento.valorEstimado) | number:'1.0-0' }}</span>
            </div>
          </div>
        </mat-card-subtitle>
      </mat-card-header>

      <mat-card-content>
        <!-- Descripción principal -->
        <div class="descripcion" *ngIf="evento.descripcion">
          <h3><mat-icon>description</mat-icon> Descripción del Evento</h3>
          <div [innerHTML]="descripcionSanitizada || evento.descripcion"></div>
        </div>

        <!-- Equipos enfrentados -->
        <div class="equipos-section" *ngIf="evento.equipoLocal || evento.equipoVisitante">
          <h3><mat-icon>sports_soccer</mat-icon> Equipos</h3>
          <div class="equipos-container">
            <div class="equipo" *ngIf="evento.equipoLocal">
              <mat-icon>home</mat-icon>
              <span class="equipo-label">Local:</span>
              <span class="equipo-nombre">{{ evento.equipoLocal }}</span>
            </div>
            <div class="vs-divider" *ngIf="evento.equipoLocal && evento.equipoVisitante">
              <span>VS</span>
            </div>
            <div class="equipo" *ngIf="evento.equipoVisitante">
              <mat-icon>flight_takeoff</mat-icon>
              <span class="equipo-label">Visitante:</span>
              <span class="equipo-nombre">{{ evento.equipoVisitante }}</span>
            </div>
          </div>
        </div>

        <mat-divider></mat-divider>

        <!-- Sección de compartir -->
        <div class="compartir-section">
          <h3><mat-icon>share</mat-icon> Compartir Evento</h3>
          <div class="compartir-buttons">
            <!-- Botón principal de compartir -->
            <button mat-raised-button color="primary" (click)="compartirEvento()" class="compartir-btn">
              <mat-icon>share</mat-icon>
              Compartir
            </button>

            <!-- Menú de redes sociales -->
            <button mat-icon-button [matMenuTriggerFor]="shareMenu" matTooltip="Más opciones de compartir">
              <mat-icon>more_vert</mat-icon>
            </button>

            <mat-menu #shareMenu="matMenu">
              <button mat-menu-item (click)="compartirEnRedSocial('whatsapp')">
                <mat-icon>message</mat-icon>
                <span>WhatsApp</span>
              </button>
              <button mat-menu-item (click)="compartirEnRedSocial('facebook')">
                <mat-icon>facebook</mat-icon>
                <span>Facebook</span>
              </button>
              <button mat-menu-item (click)="compartirEnRedSocial('twitter')">
                <mat-icon>alternate_email</mat-icon>
                <span>Twitter</span>
              </button>
              <button mat-menu-item (click)="compartirEnRedSocial('telegram')">
                <mat-icon>send</mat-icon>
                <span>Telegram</span>
              </button>
            </mat-menu>
          </div>
        </div>

        <!-- Detalles adicionales -->
        <div class="evento-detalles">
          <h3><mat-icon>info</mat-icon> Información del Evento</h3>
          
          <div class="detalle-item" *ngIf="evento.tipoEvento">
            <h4><mat-icon>sports_soccer</mat-icon> Tipo de Evento</h4>
            <p>{{ evento.tipoEvento }}</p>
          </div>
          
          <div class="detalle-item" *ngIf="evento.competicion || evento.competencia">
            <h4><mat-icon>emoji_events</mat-icon> Competición</h4>
            <p>{{ evento.competicion || evento.competencia }}</p>
          </div>
          
          <div class="detalle-item" *ngIf="evento.importancia">
            <h4><mat-icon>priority_high</mat-icon> Importancia</h4>
            <p>{{ evento.importancia }}</p>
          </div>
          
          <div class="detalle-item" *ngIf="evento.lugar">
            <h4><mat-icon>stadium</mat-icon> Lugar</h4>
            <p>{{ evento.lugar }}</p>
          </div>
          
          <div class="detalle-item" *ngIf="evento.ciudad">
            <h4><mat-icon>location_city</mat-icon> Ciudad</h4>
            <p>{{ evento.ciudad }}</p>
          </div>
          
          <div class="detalle-item" *ngIf="evento.estado">
            <h4><mat-icon>event_available</mat-icon> Estado</h4>
            <p>{{ evento.estado }}</p>
          </div>
          
          <div class="detalle-item" *ngIf="evento.precioEstimado || evento.valorEstimado">
            <h4><mat-icon>attach_money</mat-icon> Precio Estimado</h4>
            <p>${{ (evento.precioEstimado || evento.valorEstimado) | number:'1.0-0' }}</p>
          </div>
          
          <div class="detalle-item" *ngIf="evento.tags">
            <h4><mat-icon>label</mat-icon> Tags</h4>
            <p>{{ evento.tags }}</p>
          </div>
          
          <div class="detalle-item" *ngIf="evento.notas">
            <h4><mat-icon>notes</mat-icon> Notas</h4>
            <p>{{ evento.notas }}</p>
          </div>
          
          <div class="detalle-item" *ngIf="evento.seccionNombre">
            <h4><mat-icon>folder</mat-icon> Sección</h4>
            <p>{{ evento.seccionNombre }}</p>
          </div>
          
          <div class="detalle-item" *ngIf="evento.fecha">
            <h4><mat-icon>calendar_today</mat-icon> Fecha Completa</h4>
            <p>{{ extraerFecha(evento.fecha) | date:'EEEE, dd \'de\' MMMM \'de\' yyyy':'es' }}</p>
          </div>
          
          <div class="detalle-item" *ngIf="evento.hora">
            <h4><mat-icon>schedule</mat-icon> Hora del Evento</h4>
            <p>{{ extraerHora(evento.fecha, evento.hora) }} hrs</p>
          </div>
          
          <div class="detalle-item" *ngIf="evento.creadorNombre">
            <h4><mat-icon>person</mat-icon> Creado por</h4>
            <p>{{ evento.creadorNombre }}</p>
          </div>
          
          <div class="detalle-item" *ngIf="evento.id">
            <h4><mat-icon>fingerprint</mat-icon> ID del Evento</h4>
            <p>#{{ evento.id }}</p>
          </div>
          
          <div class="detalle-item" *ngIf="evento.visitas">
            <h4><mat-icon>visibility</mat-icon> Visualizaciones</h4>
            <p>{{ evento.visitas }} {{ evento.visitas === 1 ? 'visita' : 'visitas' }}</p>
          </div>
        </div>

        <!-- Video si existe -->
        <div class="video-container" *ngIf="evento.videoUrl">
          <h3><mat-icon>play_circle</mat-icon> Video del Evento</h3>
          <div class="video-wrapper">
            <iframe 
              [src]="evento.videoUrl" 
              width="100%" 
              height="400" 
              frameborder="0" 
              allowfullscreen>
            </iframe>
          </div>
        </div>

        <!-- Información adicional -->
        <div class="info-adicional">
          <h3><mat-icon>info</mat-icon> Resumen del Evento</h3>
          <div class="info-grid">
            <div class="info-item" *ngIf="evento.tipoEvento">
              <strong>Tipo:</strong> {{ evento.tipoEvento }}
            </div>
            <div class="info-item" *ngIf="!evento.tipoEvento">
              <strong>Tipo:</strong> Evento deportivo
            </div>
            
            <div class="info-item" *ngIf="evento.competicion || evento.competencia">
              <strong>Competición:</strong> {{ evento.competicion || evento.competencia }}
            </div>
            
            <div class="info-item" *ngIf="evento.importancia">
              <strong>Importancia:</strong> {{ evento.importancia }}
            </div>
            
            <div class="info-item" *ngIf="evento.lugar">
              <strong>Lugar:</strong> {{ evento.lugar }}
            </div>
            
            <div class="info-item" *ngIf="evento.ciudad">
              <strong>Ciudad:</strong> {{ evento.ciudad }}
            </div>
            
            <div class="info-item" *ngIf="evento.fecha">
              <strong>Fecha:</strong> {{ extraerFecha(evento.fecha) | date:'dd/MM/yyyy':'es' }}
            </div>
            
            <div class="info-item" *ngIf="evento.hora">
              <strong>Hora:</strong> {{ extraerHora(evento.fecha, evento.hora) }}
            </div>
            
            <div class="info-item" *ngIf="evento.estado">
              <strong>Estado:</strong> {{ evento.estado }}
            </div>
            
            <div class="info-item" *ngIf="evento.precioEstimado || evento.valorEstimado">
              <strong>Precio:</strong> ${{ (evento.precioEstimado || evento.valorEstimado) | number:'1.0-0' }}
            </div>
            
            <div class="info-item" *ngIf="evento.equipoLocal">
              <strong>Equipo Local:</strong> {{ evento.equipoLocal }}
            </div>
            
            <div class="info-item" *ngIf="evento.equipoVisitante">
              <strong>Equipo Visitante:</strong> {{ evento.equipoVisitante }}
            </div>
            
            <div class="info-item" *ngIf="evento.tags">
              <strong>Tags:</strong> {{ evento.tags }}
            </div>
            
            <div class="info-item" *ngIf="evento.seccionNombre">
              <strong>Sección:</strong> {{ evento.seccionNombre }}
            </div>
          </div>
        </div>
      </mat-card-content>
    </mat-card>
  </div>

  <!-- Error si no se encuentra el evento -->
  <div *ngIf="!cargando && !evento" class="error-container">
    <mat-card class="error-card">
      <mat-card-content>
        <mat-icon class="error-icon">error_outline</mat-icon>
        <h2>Evento no encontrado</h2>
        <p>El evento que buscas no existe o ha sido eliminado.</p>
        <button mat-raised-button color="primary" (click)="volverAlDashboard()">
          <mat-icon>home</mat-icon>
          Volver al Dashboard
        </button>
      </mat-card-content>
    </mat-card>
  </div>
</div>
