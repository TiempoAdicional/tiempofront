<!-- Botón de vuelta al dashboard -->
<div class="boton-vuelta-container">
  <button mat-fab 
          color="primary" 
          class="boton-vuelta-dashboard"
          [routerLink]="['/admin']"
          matTooltip="Volver a Secciones"
          aria-label="Volver a Secciones">
    <mat-icon>arrow_back</mat-icon>
  </button>
</div>

<section class="contenedor-crear-editar">
  <mat-card class="card-formulario">
    
    <mat-card-header class="header-formulario">
      <mat-card-title class="titulo-formulario">
        <mat-icon color="accent">{{ getIconoComponente() }}</mat-icon>
        {{ getTituloComponente() }}
      </mat-card-title>
      <mat-card-subtitle class="subtitulo-formulario">
        {{ isEditMode ? 'Modifica los datos de la sección' : 'Crea una nueva sección para organizar tu periódico deportivo' }}
      </mat-card-subtitle>
    </mat-card-header>

    <form [formGroup]="form" (ngSubmit)="onSubmit()" class="formulario-seccion">

      <!-- Título de la sección -->
      <mat-form-field appearance="outline" class="campo-formulario">
        <mat-label>Título de la sección</mat-label>
        <input matInput 
               formControlName="titulo" 
               placeholder="Ej: Noticias Destacadas"
               maxlength="50">
        <mat-icon matSuffix>title</mat-icon>
        <mat-hint>{{ titulo?.value?.length || 0 }}/50</mat-hint>
        <mat-error *ngIf="titulo?.hasError('required')">
          El título es obligatorio
        </mat-error>
        <mat-error *ngIf="titulo?.hasError('minlength')">
          El título debe tener al menos 3 caracteres
        </mat-error>
        <mat-error *ngIf="titulo?.hasError('maxlength')">
          El título no puede superar los 50 caracteres
        </mat-error>
      </mat-form-field>

      <!-- Descripción -->
      <mat-form-field appearance="outline" class="campo-formulario">
        <mat-label>Descripción (opcional)</mat-label>
        <textarea matInput 
                  formControlName="descripcion" 
                  rows="3" 
                  placeholder="Descripción breve de qué contenido irá en esta sección"
                  maxlength="200"></textarea>
        <mat-icon matSuffix>description</mat-icon>
        <mat-hint>{{ descripcion?.value?.length || 0 }}/200</mat-hint>
        <mat-error *ngIf="descripcion?.hasError('maxlength')">
          La descripción no puede superar los 200 caracteres
        </mat-error>
      </mat-form-field>

      <!-- Tipo de contenido -->
      <mat-form-field appearance="outline" class="campo-formulario">
        <mat-label>Tipo de contenido</mat-label>
        <mat-select formControlName="tipo">
          <mat-option *ngFor="let tipo of tipos" [value]="tipo.value">
            <mat-icon [color]="tipo.value === 'NOTICIAS' ? 'primary' : tipo.value === 'EVENTOS' ? 'accent' : 'warn'">
              {{ tipo.icon }}
            </mat-icon>
            {{ tipo.label }}
          </mat-option>
        </mat-select>
        <mat-icon matSuffix>category</mat-icon>
        <mat-error *ngIf="tipo?.hasError('required')">
          Debes seleccionar un tipo de contenido
        </mat-error>
      </mat-form-field>

      <!-- Orden -->
      <mat-form-field appearance="outline" class="campo-formulario">
        <mat-label>Orden de aparición</mat-label>
        <input matInput 
               type="number" 
               formControlName="orden" 
               min="1" 
               max="100">
        <mat-icon matSuffix>sort</mat-icon>
        <mat-hint>Define en qué posición aparecerá esta sección en el periódico</mat-hint>
        <mat-error *ngIf="orden?.hasError('required')">
          El orden es obligatorio
        </mat-error>
        <mat-error *ngIf="orden?.hasError('min')">
          El orden debe ser mayor a 0
        </mat-error>
      </mat-form-field>

      <!-- Estado activa/inactiva -->
      <div class="campo-checkbox">
        <mat-checkbox formControlName="activa" color="accent">
          <span class="etiqueta-checkbox">
            <mat-icon>{{ activa?.value ? 'visibility' : 'visibility_off' }}</mat-icon>
            Sección activa
          </span>
        </mat-checkbox>
        <p class="ayuda-checkbox">
          Las secciones inactivas no aparecerán en el periódico público
        </p>
      </div>

      <!-- Estado visible/oculta -->
      <div class="campo-checkbox">
        <mat-checkbox formControlName="visible" color="primary">
          <span class="etiqueta-checkbox">
            <mat-icon>{{ visible?.value ? 'public' : 'public_off' }}</mat-icon>
            Sección visible
          </span>
        </mat-checkbox>
        <p class="ayuda-checkbox">
          Las secciones no visibles están ocultas para los usuarios
        </p>
      </div>

      <!-- Botones de acción -->
      <div class="botones-accion">
        <button mat-raised-button 
                color="primary" 
                type="submit" 
                [disabled]="form.invalid || cargando"
                class="boton-guardar">
          <mat-icon>{{ isEditMode ? 'save' : 'add' }}</mat-icon>
          {{ isEditMode ? 'Actualizar Sección' : 'Crear Sección' }}
        </button>

        <button mat-stroked-button 
                type="button" 
                (click)="cancelar()"
                class="boton-cancelar">
          <mat-icon>cancel</mat-icon>
          Cancelar
        </button>
      </div>

    </form>

  </mat-card>
</section>
